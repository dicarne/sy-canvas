import{d as C,r as h,a as x,l as I,o as J,c as F,b as N,u as R,e as A,f as z,g as B,h as n,i,w as d,N as w,j as E,k as H,m as y,n as V,p as j,F as q,q as p,t as K,s as X,v as Y,x as G}from"./vendor.b25c92ac.js";const Q=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const v of u.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&r(v)}).observe(document,{childList:!0,subtree:!0});function e(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerpolicy&&(u.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?u.credentials="include":l.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(l){if(l.ep)return;l.ep=!0;const u=e(l);fetch(l.href,u)}};Q();function Z(m){var a=atob(m),e=decodeURI(a);return e}const ee=["width","height"],te={style:{position:"fixed",bottom:"0px",width:"100vw",backgroundColor:"#fff",paddingTop:"10px",paddingLeft:"5px"}},oe=p("\u8BBE\u7F6E"),ne=p("\u64A4\u9500"),le=p(" \u80CC\u666F\u989C\u8272 "),ue=p("\u6E05\u7A7A"),ae=p("\u53D6\u6D88"),se=p("\u786E\u8BA4"),ie=C({setup(m){const a=h(null),e=h(),r=x({w:1e3,h:1e3}),l=h(!1),u=h([]),v=h({width:2,color:"#000000",points:[]}),c=x({color:"#000",width:3,background:"#fff"}),g=I.exports.throttle(()=>{!e.value||(e.value.fillStyle=c.background,e.value.fillRect(0,0,r.w,r.h),u.value.forEach(o=>{if(!(!e.value||o.points.length<=1)){e.value.beginPath(),e.value.strokeStyle=o.color,e.value.lineJoin="round",e.value.lineWidth=o.width,e.value.moveTo(o.points[0].x,o.points[0].y);for(let t=1;t<o.points.length;t++){const s=o.points[t];e.value.lineTo(s.x,s.y)}e.value.stroke(),e.value.closePath()}}))},500);J(async()=>{const o=F();if(a.value){if(e.value=a.value.getContext("2d"),!e.value)return;e.value.imageSmoothingEnabled=!0,r.w=a.value.clientWidth,r.h=a.value.clientHeight;const t=await N.getBlockAttr(o,"custom-data");if(t){const s=JSON.parse(Z(t.value));u.value=s.stokes,c.background=s.config.background,c.color=s.config.color,c.width=s.config.width}setTimeout(g,1)}window.onresize=()=>{r.w=a.value.clientWidth,r.h=a.value.clientHeight,e.value=a.value.getContext("2d"),setTimeout(g,1)}});const T=()=>a.value?{w:a.value.clientWidth,h:a.value.clientHeight}:null,_=o=>{const t=T();return{x:Math.trunc(o.clientX/t.w*r.w),y:Math.trunc(o.clientY/t.h*r.h)}},P=o=>{const t=_(o);l.value=!0,!!e.value&&(e.value.beginPath(),v.value={width:c.width,color:c.color,points:[t]},e.value.moveTo(t.x,t.y),e.value.strokeStyle=v.value.color,e.value.lineJoin="round",e.value.lineWidth=v.value.width)},S=o=>{!e.value||(v.value.points.push(o),e.value.lineTo(o.x,o.y),e.value.stroke())},M=o=>{if(l.value){const t=_(o);S(t)}},k=()=>{N.setBlockAttrs({id:F(),attrs:{"custom-data":btoa(encodeURI(JSON.stringify({version:1,stokes:K(u.value),config:c})))}})},b=o=>{if(l.value){if(l.value=!1,!e.value)return;const t=_(o);e.value.lineTo(t.x,t.y),e.value.stroke(),e.value.closePath(),u.value.push(v.value),v.value=null,k()}},D=o=>{c.color=o},O=h(["#FFFFFF","#000","#18A058","#2080F0","#F0A020","rgba(208, 48, 80, 1)"]),f=x({show:!1,background:"#fff",changeColor:o=>{f.background=o},ok:()=>{c.background=f.background,f.show=!1,k(),setTimeout(g,1)}}),W=()=>{u.value.splice(u.value.length-1,1),g(),k()},L=R(),U=()=>{L.warning({title:"\u8B66\u544A",content:"\u662F\u5426\u6E05\u7A7A\u6240\u6709\u5185\u5BB9\uFF1F\u8BE5\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\uFF01",positiveText:"\u786E\u5B9A",negativeText:"\u4E0D\u786E\u5B9A",onPositiveClick:()=>{u.value=[],c.background="#fff",g(),k(),f.show=!1},onNegativeClick:()=>{}})};return(o,t)=>(A(),z(q,null,[B("canvas",{style:{width:"100vw",height:"100vh"},width:n(r).w,height:n(r).h,ref:(s,$)=>{$.canvas=s,a.value=s},onmousedown:P,onmousemove:M,onmouseleave:b,onmouseup:b},null,8,ee),B("div",te,[i(n(y),null,{default:d(()=>[i(n(w),{onClick:t[0]||(t[0]=s=>n(f).show=!0)},{default:d(()=>[oe]),_:1}),i(n(w),{onClick:t[1]||(t[1]=s=>W())},{default:d(()=>[ne]),_:1}),i(n(E),{"on-update:value":D,style:{width:"40vw",minWidth:"300px",maxWidth:"500px"},"show-alpha":!1,swatches:O.value},null,8,["swatches"]),i(n(H),{value:n(c).width,"onUpdate:value":t[2]||(t[2]=s=>n(c).width=s),step:1,min:1,max:20,style:{width:"40vw",minWidth:"300px",maxWidth:"500px"}},null,8,["value"])]),_:1})]),i(n(j),{show:n(f).show,"onUpdate:show":t[5]||(t[5]=s=>n(f).show=s),style:{position:"fixed",top:"10px"}},{default:d(()=>[i(n(V),{style:{width:"100vw"},title:"\u8BBE\u7F6E",bordered:!1,size:"huge"},{footer:d(()=>[i(n(y),null,{default:d(()=>[i(n(w),{onClick:t[3]||(t[3]=s=>n(f).show=!1)},{default:d(()=>[ae]),_:1}),i(n(w),{onClick:t[4]||(t[4]=s=>n(f).ok())},{default:d(()=>[se]),_:1})]),_:1})]),default:d(()=>[le,i(n(E),{"show-alpha":!1,"on-update:value":n(f).changeColor,"default-value":n(c).background},null,8,["on-update:value","default-value"]),i(n(y),null,{default:d(()=>[i(n(w),{onClick:U},{default:d(()=>[ue]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])],64))}});const re=C({setup(m){return(a,e)=>(A(),X(n(Y),null,{default:d(()=>[i(ie)]),_:1}))}});G(re).mount("#app");
//# sourceMappingURL=index.c9b106b5.js.map
